--
-- Source code generated by Celerio, a Jaxio product.
-- Documentation: http://www.jaxio.com/documentation/celerio/
-- Follow us on twitter: @jaxiosoft
-- Need commercial support ? Contact us: info@jaxio.com
-- Template pack-backend-jpa:src/main/sql/h2/01-create.p.vm.sql
-- Template is part of Open Source Project: https://github.com/jaxio/pack-backend-jpa
--

DROP ALL objects;


-- =================================
-- TABLE ds_database_provider_type 
-- =================================

CREATE TABLE ds_database_provider_type (
	dp_name VARCHAR(20),
	dp_label VARCHAR(40),
	dp_description VARCHAR(100));


-- =================================
-- TABLE ds_transaction 
-- =================================

CREATE TABLE ds_transaction (
	tx_id INTEGER(10) not null,
	tx_name VARCHAR(20));

CREATE UNIQUE INDEX IF NOT EXISTS ds_transaction_pkey ON ds_transaction (tx_id);
ALTER TABLE ds_transaction ALTER COLUMN tx_id IDENTITY;


-- =================================
-- TABLE ds_tx_stock_price 
-- =================================

CREATE TABLE ds_tx_stock_price (
	tx_stock_price_fk_tx_id INTEGER(10) not null,
	tx_dataset_id INTEGER(10),
	tx_dataset_code VARCHAR(4),
	tx_database_name VARCHAR(20),
	tx_name VARCHAR(60),
	tx_refreshed_at DATE,
	tx_newest_available_date DATE,
	tx_oldest_available_date DATE,
	tx_frequency VARCHAR(20),
	tx_type VARCHAR(20),
	tx_premium_type BIT(1));

CREATE UNIQUE INDEX IF NOT EXISTS tx_stock_price_pkey ON ds_tx_stock_price (tx_stock_price_fk_tx_id);
ALTER TABLE ds_tx_stock_price ALTER COLUMN tx_stock_price_fk_tx_id IDENTITY;


-- =================================
-- TABLE ds_tx_stock_price_values 
-- =================================

CREATE TABLE ds_tx_stock_price_values (
	spv_id INTEGER(10) not null,
	spv_date DATE,
	spv_open NUMERIC(131089),
	spv_high NUMERIC(131089),
	spv_low NUMERIC(131089),
	spv_last NUMERIC(131089),
	spv_volume NUMERIC(131089),
	spv_turnover NUMERIC(131089),
	spv_fk_sp_id INTEGER(10));

CREATE UNIQUE INDEX IF NOT EXISTS tx_stock_price_values_pkey ON ds_tx_stock_price_values (spv_id);
ALTER TABLE ds_tx_stock_price_values ALTER COLUMN spv_id IDENTITY;

ALTER TABLE ds_tx_stock_price ADD CONSTRAINT DF_TX_STOCK_PRICE_TX_STOCK_PRICE_FK_TX_ID_FKEY FOREIGN KEY (tx_stock_price_fk_tx_id) REFERENCES ds_transaction (tx_id);
ALTER TABLE ds_tx_stock_price_values ADD CONSTRAINT TX_STOCK_PRICE_VALUES_FK_STOCK_PRICE_ID_FKEY FOREIGN KEY (spv_fk_sp_id) REFERENCES ds_tx_stock_price (tx_stock_price_fk_tx_id);